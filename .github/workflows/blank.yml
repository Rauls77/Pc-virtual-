name: Windows Cloud PC - Anydesk (With Save)

on:
  workflow_dispatch:

jobs:
  build:
    name: Infinite Execution with Save
    runs-on: windows-latest
    timeout-minutes: 10080

    steps:
      # Configurar o repositório
      - name: Checkout Repository
        uses: actions/checkout@v3

      # Baixar e instalar componentes essenciais
      - name: Downloading & Installing Essentials
        run: |
          Invoke-WebRequest -Uri "https://www.dropbox.com/scl/fi/7eiczvgil84czu55dxep3/Downloads.bat?rlkey=wzdc1wxjsph2b7r0atplmdz3p&dl=1" -OutFile "Downloads.bat"
          cmd /c Downloads.bat

      # Salvar estado do sistema ou arquivos
      - name: Save Files or Configurations
        run: |
          # Exemplo: Criar/atualizar um arquivo de log
          $logContent = "Última execução: $(Get-Date)"
          $logFile = "log.txt"
          Set-Content -Path $logFile -Value $logContent

      # Commit automático das alterações
      - name: Commit and Push Changes
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add .
          git commit -m "Salvando alterações automáticas - $(Get-Date)" || echo "Nada a commitar"
          git push

      # Simulação de execução infinita
      - name: Simulate Infinite Execution
        run: |
          while ($true) {
            Write-Host "Job ainda está ativo às $(Get-Date)"
            Start-Sleep -Seconds 3600
          }
